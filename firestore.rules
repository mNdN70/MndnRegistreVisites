/**
 * @file Overview
 * This ruleset enforces a basic security model where any authenticated user can read all data,
 * but write access is completely forbidden in this prototype to prevent accidental data modification.
 *
 * Data Structure:
 * - /persons_to_visit/{personToVisitId}: Stores information about people who can be visited.
 * - /visits/{visitId}: Stores visit records.
 *
 * Key Security Decisions:
 * - Read access is open to all authenticated users for prototyping purposes.
 * - Write access (create, update, delete) is completely denied to prevent accidental data modification during prototyping.
 * - The prototype does not enforce any data validation beyond requiring authentication for access.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows any authenticated user to read information about people to visit.  Writes are forbidden.
     * @path /persons_to_visit/{personToVisitId}
     * @allow (get, list) User with any valid auth can read person to visit data.
     * @deny (create, update, delete) No one can modify person to visit data in this prototype.
     * @principle Allows open reads for authenticated users during prototyping, but prevents all writes.
     */
    match /persons_to_visit/{personToVisitId} {
      allow get, list: if isSignedIn();
      allow create, update, delete: if false;
    }

    /**
     * @description Allows any authenticated user to read visit records. Writes are forbidden.
     * @path /visits/{visitId}
     * @allow (get, list) User with any valid auth can read visit data.
     * @deny (create, update, delete) No one can modify visit data in this prototype.
     * @principle Allows open reads for authenticated users during prototyping, but prevents all writes.
     */
    match /visits/{visitId} {
      allow get, list: if isSignedIn();
      allow create, update, delete: if false;
    }

    /**
     * @description Checks if the user is signed in.
     * @return {bool} True if the user is signed in, false otherwise.
     */
    function isSignedIn() {
      return request.auth != null;
    }
  }
}